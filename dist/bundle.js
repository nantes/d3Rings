!function(t){var e={};function s(a){if(e[a])return e[a].exports;var i=e[a]={i:a,l:!1,exports:{}};return t[a].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=t,s.c=e,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(a,i,function(e){return t[e]}.bind(null,i));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){t.exports=s(1)},function(t,e,s){"use strict";s.r(e);class a{constructor(t){this.endpoint=t,this.maxWidth=290,this.nextLine=60,this.fetchData()}init(){this.element=d3.select("#rings-container").append("li").attr("class","ring-container").append("div").attr("id",this.dataset.title).attr("class","ring"),this.width=parseInt(d3.select("#"+this.dataset.title).style("width")),this.height=320,console.log("this height ",this.height),this.radius=this.width/3.5,this.thickness=10,this.margin={top:(this.height-this.radius)/2,right:(this.width-this.radius)/2,bottom:(this.height-this.radius)/2,left:(this.width-this.radius)/2},this.center={x:this.width/2,y:this.height/2+15},this.element.innerHTML="",this.total=this.dataset.items.reduce((t,e)=>t+e.value,0),this.domain=this.dataset.items.map(t=>t.name),this.draw()}draw(){this.svgViewport=this.element.append("svg").attr("width",this.width).attr("height",this.height+parseInt((this.dataset.items.length-1)/2)*this.nextLine);const t=this.svgViewport.append("g").attr("transform",`translate(${this.center.x},${this.center.y})`),e=d3.pie().sort(null).value(t=>t.value),s=d3.arc().outerRadius(this.radius).innerRadius(this.radius-this.thickness),a=this.dataset.items.map(t=>t.color),i=this.dataset.items.map(t=>t.name),r=d3.scaleOrdinal(a);r.domain=i,t.selectAll("path").data(e(this.dataset.items)).enter().append("path").attr("class","arc").attr("d",s).attr("stroke","#fff").attr("stroke-width",1).attr("fill",t=>r(t.data.name)),this.drawTitles(),this.drawItemsText()}drawTitles(){const t=this.svgViewport.append("g").attr("class","circle");t.append("text").attr("text-anchor","middle").attr("x",this.center.x).attr("y",this.center.y-15).attr("class","circle-label").text(this.dataset.title.toUpperCase()),t.append("text").attr("text-anchor","middle").attr("x",this.center.x).attr("y",this.center.y+15).attr("class","circle-value").text(()=>{let t=this.formatThousands(this.total,"de");return"Revenue"==this.dataset.title?t+="€":t})}drawItemsText(){const t=this.svgViewport.append("g").attr("class","rect");t.append("rect").attr("x",0).attr("y",260).attr("width","320").attr("height","120").attr("fill","none").attr("class","circle-title");for(let e=0;e<this.dataset.items.length;e++)t.append("text").attr("text-anchor",e%2==0?"start":"end").attr("x",e%2==0?0:this.maxWidth).attr("y",275+parseInt(e/2)*this.nextLine).attr("class","details-label").attr("fill",this.dataset.items[e].color).text(this.capitalizeFirstLetter(this.dataset.items[e].name)),t.append("text").attr("text-anchor",e%2==0?"start":"end").attr("x",e%2==0?0:200).attr("y",305+parseInt(e/2)*this.nextLine).attr("class","details-percent").text(this.percent(this.dataset.items[e].value).toFixed(0)+"%"),t.append("text").attr("text-anchor",e%2==0?"start":"end").attr("x",e%2==0?40:this.maxWidth).attr("y",305+parseInt(e/2)*this.nextLine).attr("class","details-value").text(()=>{let t=this.formatThousands(this.dataset.items[e].value);return"Revenue"==this.dataset.title?t+="€":t})}fetchData(){d3.json(this.endpoint).then(t=>this.setData(t))}setData(t){this.dataset=t,this.init()}getData(){return this.dataset}redraw(){this.init()}percent(t){if(null!=typeof t)return t/this.total*100}formatThousands(t,e){if(null!=typeof t)return t.toLocaleString(e)}capitalizeFirstLetter(t){if(null==typeof t)return;let e=t[0]||t.charAt(0);return e?e.toUpperCase()+t.slice(1):""}}class i{constructor(t){this.key=t.key,this.ring=t.ring,this.draw()}draw(){this.element=d3.select(".dots").append("span").attr("class","dot").attr("id","dot"+this.key)}addListenerClick(t,e,s){t.addEventListener("click",t=>{t.preventDefault();for(let t=0;t<e;t++)s[t].removeClass();const a=-350*parseInt(t.srcElement.id.slice(3));t.srcElement.classList.add("selected"),this.updateGraphicsPanel(a)})}addClass(t){this.element.attr("class","dot "+t)}removeClass(){this.element.attr("class","dot")}updateGraphicsPanel(t){window.document.getElementById("rings-container").style.transform="translateX("+t+"px)"}}new class{constructor(t){this.database=t,this.init()}init(){this.rings=this.database.map(t=>new a(t)),this.dots=[],this.rings.forEach((t,e)=>{this.dots.push(new i({ring:t,key:e})),this.dots[e].removeClass(),this.dots[e].addListenerClick(document.getElementById("dot"+e),this.rings.length,this.dots)}),this.dots[0].addClass("selected")}}(["/database/revenue.json","/database/impresions.json","/database/visits.json"])}]);